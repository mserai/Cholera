<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>

  <head>
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <!--Semantic UI-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.2/semantic.min.css">
  </head>

</head>
<body>
<div style = "position: absolute; top: 0; right: 0; bottom: 0; left: 0;" id = "myDiv"></div>
<script>
  Plotly.d3.csv('https://raw.githubusercontent.com/idemello/Cholera484/master/choleraDeathLocations.csv', function(err, rows){
    Plotly.d3.csv("https://raw.githubusercontent.com/idemello/Cholera484/master/choleraPumpLocations.csv", function(err2, rows2) {
      function unpack(rows, key) {
        return rows.map(function (row) {
          return row[key];
        });
      }
      scl = [[0, 'rgb(150,0,90)'], [0.125, 'rgb(0, 0, 200)'], [0.25, 'rgb(0, 25, 255)'], [0.375, 'rgb(0, 152, 255)'], [0.5, 'rgb(44, 255, 150)'], [0.625, 'rgb(151, 255, 0)'], [0.75, 'rgb(255, 234, 0)'], [0.875, 'rgb(255, 111, 0)'], [1, 'rgb(255, 0, 0)']];
      var data = [{
        type: 'scattermapbox',
        mode: 'markers',
        text: unpack(rows, 'Deaths'),
        lon: unpack(rows, 'PumpLon'),
        lat: unpack(rows, 'PumpLat'),
        marker: {
          color: unpack(rows, 'Deaths'),
          colorscale: scl,
          cmin: 0,
          cmax: 1.4,
          reversescale: true,
          opacity: 0.5,
          size: 10,
          colorbar: {
            thickness: 10,
            titleside: 'right',
            outlinecolor: 'rgba(68,68,68,0)',
            ticks: 'outside',
            ticklen: 3,
            shoticksuffix: 'last',
            ticksuffix: 'inches',
            dtick: 0.1
          }
        },
        name: 'NA Precipitation'
      }];
      layout = {
        dragmode: 'zoom',
        mapbox: {
          center: {
            lat: 51.513603,
            lon: -0.136217
          },
          domain: {
            x: [0, 1],
            y: [0, 1]
          },
          style: 'light',
          zoom: 16.8
        },
        margin: {
          r: 0,
          t: 0,
          b: 0,
          l: 0,
          pad: 0
        },
        showlegend: false
      };
      Plotly.setPlotConfig({
        mapboxAccessToken: 'pk.eyJ1IjoiaWRlbWVsbG8iLCJhIjoiY2ptNnFiZmc5MDJoZzNwdXE2aXhiYXNqdCJ9.qKCVHMu9enwE6uzCJRDgFw'
      });
      Plotly.newPlot('myDiv', data, layout);
    })
  });

</script>

</body>
</html>